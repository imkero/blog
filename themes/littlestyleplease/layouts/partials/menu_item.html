{{- $pctx := . -}}

{{- range $item := .collection -}}
    {{- if $item.title }}
        {{- if eq $pctx.type "list" }}
        <li>
        {{- else if eq $item.type "h2" }}
        <h2>
        {{- end -}}
            {{- with $item.url -}}
                <a href="{{ $item.url }}">{{ safeHTML $item.title }}</a>
            {{- else -}}
                {{ safeHTML $item.title }}
            {{- end -}}
        {{- if eq $item.type "h2" }}
        </h2>
        {{- else if eq $pctx.type "list" }}
        </li>
        {{- end -}}
    {{- end -}}

    {{- if $item.entries }}
        {{- if eq $item.type "list" }}
        <ul>
        {{- else if eq $item.type "nav" }}
        <nav>
        {{- end -}}

        {{ partial "menu_item.html" (dict "context" . "type" $item.type "collection" $item.entries) }}

        {{- if eq .type "list" }}
        <ul>
        {{- else if eq $item.type "nav" }}
        </nav>
        {{- else if eq $item.type "h2" }}
        </h2>
        {{- end -}}
    {{- end -}}

    {{- if $item.post_list -}}
        {{ partial "post_list.html" (dict 
            "context" .
            "section" $item.post_list.section
            "limit" $item.post_list.limit
            "show_more" $item.post_list.show_more
            "show_more_text" $item.post_list.show_more_text
            "show_more_url" $item.post_list.show_more_url
            ) -}}
    {{- end -}}
{{- end -}}


    